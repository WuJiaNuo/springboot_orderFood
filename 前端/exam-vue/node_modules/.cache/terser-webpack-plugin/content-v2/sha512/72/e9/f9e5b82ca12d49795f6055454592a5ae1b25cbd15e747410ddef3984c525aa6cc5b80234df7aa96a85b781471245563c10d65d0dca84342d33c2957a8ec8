{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-28607531\"],{3528:function(e,t,a){\"use strict\";a(\"99af\");var s=a(\"b775\"),n=\"/admin/system/sysRole\";t[\"a\"]={getPageList:function(e,t,a){return Object(s[\"a\"])({url:\"\".concat(n,\"/\").concat(e,\"/\").concat(t),method:\"get\",params:a})},removeId:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/remove/\").concat(e),method:\"delete\"})},saveRole:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/save\"),method:\"post\",data:e})},getRoleId:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/findRoleById/\").concat(e),method:\"get\"})},update:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/update\"),method:\"post\",data:e})},batchRemove:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/batchRemove\"),method:\"delete\",data:e})},getRolesByUserId:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/toAssign/\").concat(e),method:\"get\"})},assignRoles:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/doAssign\"),method:\"post\",data:e})}}},\"4bb7\":function(e,t,a){\"use strict\";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"app-container\"},[a(\"div\",{staticClass:\"search-div\"},[a(\"el-form\",{attrs:{\"label-width\":\"70px\",size:\"small\"}},[a(\"el-row\",[a(\"el-col\",{attrs:{span:8}},[a(\"el-form-item\",{attrs:{label:\"关 键 字\"}},[a(\"el-input\",{staticStyle:{width:\"95%\"},attrs:{placeholder:\"用户名/姓名/手机号码\"},model:{value:e.searchObj.keyword,callback:function(t){e.$set(e.searchObj,\"keyword\",t)},expression:\"searchObj.keyword\"}})],1)],1),a(\"el-col\",{attrs:{span:8}},[a(\"el-form-item\",{attrs:{label:\"操作时间\"}},[a(\"el-date-picker\",{staticStyle:{\"margin-right\":\"10px\",width:\"100%\"},attrs:{type:\"datetimerange\",\"range-separator\":\"至\",\"start-placeholder\":\"开始时间\",\"end-placeholder\":\"结束时间\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\"},model:{value:e.createTimes,callback:function(t){e.createTimes=t},expression:\"createTimes\"}})],1)],1)],1),a(\"el-row\",{staticStyle:{display:\"flex\"}},[a(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-search\",size:\"mini\"},on:{click:function(t){return e.fetchData()}}},[e._v(\"搜索\")]),a(\"el-button\",{attrs:{icon:\"el-icon-refresh\",size:\"mini\"},on:{click:e.resetData}},[e._v(\"重置\")])],1)],1)],1),a(\"div\",{staticClass:\"tools-div\"},[a(\"el-button\",{attrs:{type:\"success\",disabled:!1===e.$hasBP(\"bnt.sysUser.add\"),icon:\"el-icon-plus\",size:\"mini\"},on:{click:e.add}},[e._v(\"添 加\")])],1),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.listLoading,expression:\"listLoading\"}],staticStyle:{width:\"100%\",\"margin-top\":\"10px\"},attrs:{data:e.list,stripe:\"\",border:\"\"}},[a(\"el-table-column\",{attrs:{label:\"序号\",width:\"70\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[e._v(\" \"+e._s((e.page-1)*e.limit+t.$index+1)+\" \")]}}])}),a(\"el-table-column\",{attrs:{prop:\"username\",label:\"用户名\",width:\"180\"}}),a(\"el-table-column\",{attrs:{prop:\"name\",label:\"姓名\",width:\"110\"}}),a(\"el-table-column\",{attrs:{prop:\"phone\",label:\"手机\"}}),a(\"el-table-column\",{attrs:{prop:\"deptName\",label:\"所属部门\"}}),a(\"el-table-column\",{attrs:{label:\"状态\",width:\"80\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-switch\",{on:{change:function(a){return e.switchStatus(t.row)}},model:{value:1===t.row.status,callback:function(a){e.$set(t.row,\"status===1\",a)},expression:\"scope.row.status===1\"}})]}}])}),a(\"el-table-column\",{attrs:{prop:\"createTime\",label:\"创建时间\"}}),a(\"el-table-column\",{attrs:{label:\"操作\",align:\"center\",fixed:\"right\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-edit\",size:\"mini\",title:\"修改\"},on:{click:function(a){return e.edit(t.row.id)}}}),a(\"el-button\",{attrs:{type:\"danger\",icon:\"el-icon-delete\",size:\"mini\",title:\"删除\"},on:{click:function(a){return e.removeDataById(t.row.id)}}}),a(\"el-button\",{attrs:{type:\"warning\",icon:\"el-icon-baseball\",size:\"mini\",title:\"分配角色\"},on:{click:function(a){return e.showAssignRole(t.row)}}})]}}])})],1),a(\"el-pagination\",{staticStyle:{padding:\"30px 0\",\"text-align\":\"center\"},attrs:{\"current-page\":e.page,total:e.total,\"page-size\":e.limit,layout:\"total, prev, pager, next, jumper\"},on:{\"current-change\":e.fetchData}}),a(\"el-dialog\",{attrs:{title:\"分配角色\",visible:e.dialogRoleVisible},on:{\"update:visible\":function(t){e.dialogRoleVisible=t}}},[a(\"el-form\",{attrs:{\"label-width\":\"80px\"}},[a(\"el-form-item\",{attrs:{label:\"用户名\"}},[a(\"el-input\",{attrs:{disabled:\"\",value:e.sysUser.username}})],1),a(\"el-form-item\",{attrs:{label:\"角色列表\"}},[a(\"el-checkbox\",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:\"checkAll\"}},[e._v(\"全选\")]),a(\"div\",{staticStyle:{margin:\"15px 0\"}}),a(\"el-checkbox-group\",{on:{change:e.handleCheckedChange},model:{value:e.userRoleIds,callback:function(t){e.userRoleIds=t},expression:\"userRoleIds\"}},e._l(e.allRoles,(function(t){return a(\"el-checkbox\",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.roleName))])})),1)],1)],1),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:e.assignRole}},[e._v(\"保存\")]),a(\"el-button\",{attrs:{size:\"small\"},on:{click:function(t){e.dialogRoleVisible=!1}}},[e._v(\"取消\")])],1)],1),a(\"el-dialog\",{attrs:{title:\"添加/修改\",visible:e.dialogVisible,width:\"40%\"},on:{\"update:visible\":function(t){e.dialogVisible=t}}},[a(\"el-form\",{ref:\"dataForm\",staticStyle:{\"padding-right\":\"40px\"},attrs:{model:e.sysUser,\"label-width\":\"100px\",size:\"small\"}},[a(\"el-form-item\",{attrs:{label:\"用户名\",prop:\"username\"}},[a(\"el-input\",{model:{value:e.sysUser.username,callback:function(t){e.$set(e.sysUser,\"username\",t)},expression:\"sysUser.username\"}})],1),e.sysUser.id?e._e():a(\"el-form-item\",{attrs:{label:\"密码\",prop:\"password\"}},[a(\"el-input\",{attrs:{type:\"password\"},model:{value:e.sysUser.password,callback:function(t){e.$set(e.sysUser,\"password\",t)},expression:\"sysUser.password\"}})],1),a(\"el-form-item\",{attrs:{label:\"姓名\",prop:\"name\"}},[a(\"el-input\",{model:{value:e.sysUser.name,callback:function(t){e.$set(e.sysUser,\"name\",t)},expression:\"sysUser.name\"}})],1),a(\"el-form-item\",{attrs:{label:\"手机\",prop:\"phone\"}},[a(\"el-input\",{model:{value:e.sysUser.phone,callback:function(t){e.$set(e.sysUser,\"phone\",t)},expression:\"sysUser.phone\"}})],1),a(\"el-form-item\",{attrs:{label:\"所属部门\"}},[a(\"select-dept-tree\",{attrs:{treeTitle:\"选择部门\",dataTree:e.dataDeptTree,treeVal:e.sysUser.deptName},on:{saveTreeId:e.saveDeptId}})],1)],1),a(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{attrs:{size:\"small\",icon:\"el-icon-refresh-right\"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(\"取 消\")]),a(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-check\",size:\"small\"},on:{click:function(t){return e.saveOrUpdate()}}},[e._v(\"确 定\")])],1)],1)],1)},n=[],l=(a(\"d3b7\"),a(\"3ca3\"),a(\"ddb0\"),a(\"d81d\"),a(\"c0c7\")),o=a(\"3528\"),i=a(\"fcb7\"),r={components:{SelectDeptTree:function(){return a.e(\"chunk-365da143\").then(a.bind(null,\"2143\"))}},data:function(){return{listLoading:!1,list:null,total:0,page:1,limit:3,searchObj:{},createTimes:[],dialogVisible:!1,sysUser:{},dialogRoleVisible:!1,allRoles:[],userRoleIds:[],isIndeterminate:!1,checkAll:!1,dataDeptTree:[]}},created:function(){this.fetchData()},methods:{saveDeptId:function(e){console.log(\"回调treeId=\"+e),this.sysUser.deptId=e},fetchData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=t,this.createTimes&&2==this.createTimes.length&&(this.searchObj.createTimeBegin=this.createTimes[0],this.searchObj.createTimeEnd=this.createTimes[1]),i[\"a\"].findSelectNodes().then((function(t){console.log(\"response.data=\"+t.data),e.dataDeptTree=t.data})),l[\"a\"].getPageList(this.page,this.limit,this.searchObj).then((function(t){e.list=t.data.records,e.total=t.data.total}))},showAssignRole:function(e){var t=this;this.sysUser=e,this.dialogRoleVisible=!0,o[\"a\"].getRolesByUserId(e.id).then((function(e){t.allRoles=e.data.allRoles,console.log(t.allRoles),t.userRoleIds=e.data.userRoleIds,console.log(t.userRoleIds),t.checkAll=t.userRoleIds.length===t.allRoles.length,t.isIndeterminate=t.userRoleIds.length>0&&t.userRoleIds.length<t.allRoles.length}))},handleCheckAllChange:function(e){this.userRoleIds=e?this.allRoles.map((function(e){return e.id})):[],this.isIndeterminate=!1},handleCheckedChange:function(e){var t=this.userRoleIds,a=this.allRoles;this.checkAll=t.length===a.length&&a.length>0,this.isIndeterminate=t.length>0&&t.length<a.length},assignRole:function(){var e=this,t={userId:this.sysUser.id,roleIdList:this.userRoleIds};o[\"a\"].assignRoles(t).then((function(t){e.$message.success(t.message||\"分配角色成功\"),e.dialogRoleVisible=!1,e.fetchData(e.page)}))},switchStatus:function(e){var t=this;e.status=1===e.status?0:1,l[\"a\"].updateStatus(e.id,e.status).then((function(e){t.$message.success(e.message||\"操作成功\"),t.fetchData()}))},removeDataById:function(e){var t=this;this.$confirm(\"此操作将永久删除该用户, 是否继续?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then((function(){l[\"a\"].removeById(e).then((function(e){t.$message({type:\"success\",message:\"删除成功!\"}),t.fetchData()}))}))},edit:function(e){var t=this;this.dialogVisible=!0,l[\"a\"].getUserId(e).then((function(e){t.sysUser=e.data}))},saveOrUpdate:function(){this.sysUser.id?this.update():this.save()},update:function(){var e=this;l[\"a\"].update(this.sysUser).then((function(t){e.$message.success(\"操作成功\"),e.dialogVisible=!1,e.fetchData()}))},save:function(){var e=this;l[\"a\"].save(this.sysUser).then((function(t){e.$message.success(\"操作成功\"),e.dialogVisible=!1,e.fetchData()}))},add:function(){this.dialogVisible=!0,this.sysUser={}},resetData:function(){console.log(\"重置查询表单\"),this.searchObj={},this.createTimes=[],this.fetchData()}}},c=r,d=a(\"2877\"),u=Object(d[\"a\"])(c,s,n,!1,null,null,null);t[\"default\"]=u.exports},c0c7:function(e,t,a){\"use strict\";a(\"99af\");var s=a(\"b775\"),n=\"/admin/system/sysUser\";t[\"a\"]={getPageList:function(e,t,a){return Object(s[\"a\"])({url:\"\".concat(n,\"/\").concat(e,\"/\").concat(t),method:\"get\",params:a})},save:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/save\"),method:\"post\",data:e})},getUserId:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/getUser/\").concat(e),method:\"get\"})},update:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/update\"),method:\"post\",data:e})},removeById:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/remove/\").concat(e),method:\"delete\"})},updateStatus:function(e,t){return Object(s[\"a\"])({url:\"\".concat(n,\"/updateStatus/\").concat(e,\"/\").concat(t),method:\"get\"})},uploadFile:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/import\"),method:\"post\",data:e})}}},fcb7:function(e,t,a){\"use strict\";var s=a(\"b775\"),n=\"/admin/system/sysDept\";t[\"a\"]={findNodes:function(){return Object(s[\"a\"])({url:\"\".concat(n,\"/findNodes\"),method:\"get\"})},findSelectNodes:function(){return Object(s[\"a\"])({url:\"\".concat(n,\"/findSelectNodes\"),method:\"get\"})},getById:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/get/\").concat(e),method:\"get\"})},removeById:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/remove/\").concat(e),method:\"delete\"})},save:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/save\"),method:\"post\",data:e})},updateById:function(e){return Object(s[\"a\"])({url:\"\".concat(n,\"/update\"),method:\"put\",data:e})}}}}]);","extractedComments":[]}