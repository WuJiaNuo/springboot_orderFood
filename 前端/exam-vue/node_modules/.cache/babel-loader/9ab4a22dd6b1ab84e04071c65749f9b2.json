{"remainingRequest":"F:\\project\\base\\sourcecode\\front\\exam_vue\\node_modules\\babel-loader\\lib\\index.js!F:\\project\\base\\sourcecode\\front\\exam_vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\project\\base\\sourcecode\\front\\exam_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\project\\base\\sourcecode\\front\\exam_vue\\src\\views\\system\\sysRole\\assignAuth.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\project\\base\\sourcecode\\front\\exam_vue\\src\\views\\system\\sysRole\\assignAuth.vue","mtime":1681669375994},{"path":"F:\\project\\base\\sourcecode\\front\\exam_vue\\babel.config.js","mtime":1637306514000},{"path":"F:\\project\\base\\sourcecode\\front\\exam_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\project\\base\\sourcecode\\front\\exam_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\project\\base\\sourcecode\\front\\exam_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\project\\base\\sourcecode\\front\\exam_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBhcGkgZnJvbSAnQC9hcGkvc3lzdGVtL3N5c01lbnUnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ3JvbGVBdXRoJywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIC8vIOeUqOadpeagh+ivhuaYr+WQpuato+WcqOS/neWtmOivt+axguS4reeahOagh+ivhiwg6Ziy5q2i6YeN5aSN5o+Q5LqkCiAgICAgIHN5c01lbnVMaXN0OiBbXSwKICAgICAgLy8g5omA5pyJCiAgICAgIGRlZmF1bHRQcm9wczogewogICAgICAgIGNoaWxkcmVuOiAnY2hpbGRyZW4nLAogICAgICAgIGxhYmVsOiAnbmFtZScKICAgICAgfQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmZldGNoRGF0YSgpOwogIH0sCiAgbWV0aG9kczogewogICAgLyoKICAgIOWIneWni+WMlgogICAgKi8KICAgIGZldGNoRGF0YTogZnVuY3Rpb24gZmV0Y2hEYXRhKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHJvbGVJZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkOwogICAgICBhcGkudG9Bc3NpZ24ocm9sZUlkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICB2YXIgc3lzTWVudUxpc3QgPSByZXN1bHQuZGF0YTsKICAgICAgICBfdGhpcy5zeXNNZW51TGlzdCA9IHN5c01lbnVMaXN0OwoKICAgICAgICB2YXIgY2hlY2tlZElkcyA9IF90aGlzLmdldENoZWNrZWRJZHMoc3lzTWVudUxpc3QpOwoKICAgICAgICBjb25zb2xlLmxvZygnZ2V0UGVybWlzc2lvbnMoKSBjaGVja2VkSWRzJywgY2hlY2tlZElkcyk7CgogICAgICAgIF90aGlzLiRyZWZzLnRyZWUuc2V0Q2hlY2tlZEtleXMoY2hlY2tlZElkcyk7CiAgICAgIH0pOwogICAgfSwKCiAgICAvKgogICAg5b6X5Yiw5omA5pyJ6YCJ5Lit55qEaWTliJfooagKICAgICovCiAgICBnZXRDaGVja2VkSWRzOiBmdW5jdGlvbiBnZXRDaGVja2VkSWRzKGF1dGhzKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGluaXRBcnIgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFtdOwogICAgICByZXR1cm4gYXV0aHMucmVkdWNlKGZ1bmN0aW9uIChwcmUsIGl0ZW0pIHsKICAgICAgICBpZiAoaXRlbS5zZWxlY3QgJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggPT09IDApIHsKICAgICAgICAgIHByZS5wdXNoKGl0ZW0uaWQpOwogICAgICAgIH0gZWxzZSBpZiAoaXRlbS5jaGlsZHJlbikgewogICAgICAgICAgX3RoaXMyLmdldENoZWNrZWRJZHMoaXRlbS5jaGlsZHJlbiwgaW5pdEFycik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcHJlOwogICAgICB9LCBpbml0QXJyKTsKICAgIH0sCgogICAgLyoKICAgIOS/neWtmOadg+mZkOWIl+ihqAogICAgKi8KICAgIHNhdmU6IGZ1bmN0aW9uIHNhdmUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgLy/ojrflj5bliLDlvZPliY3lrZDoioLngrkKICAgICAgLy9jb25zdCBjaGVja2VkTm9kZXMgPSB0aGlzLiRyZWZzLnRyZWUuZ2V0Q2hlY2tlZE5vZGVzKCkKICAgICAgLy/ojrflj5bliLDlvZPliY3lrZDoioLngrnlj4rniLboioLngrkKICAgICAgdmFyIGFsbENoZWNrZWROb2RlcyA9IHRoaXMuJHJlZnMudHJlZS5nZXRDaGVja2VkTm9kZXMoZmFsc2UsIHRydWUpOwogICAgICB2YXIgaWRMaXN0ID0gYWxsQ2hlY2tlZE5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkgewogICAgICAgIHJldHVybiBub2RlLmlkOwogICAgICB9KTsKICAgICAgY29uc29sZS5sb2coaWRMaXN0KTsKICAgICAgdmFyIGFzc2dpbk1lbnVWbyA9IHsKICAgICAgICByb2xlSWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkLAogICAgICAgIG1lbnVJZExpc3Q6IGlkTGlzdAogICAgICB9OwogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICBhcGkuZG9Bc3NpZ24oYXNzZ2luTWVudVZvKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICBfdGhpczMubG9hZGluZyA9IGZhbHNlOwoKICAgICAgICBfdGhpczMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXN1bHQuJG1lc3NhZ2UgfHwgJ+WIhumFjeadg+mZkOaIkOWKnycpOwoKICAgICAgICBfdGhpczMuJHJvdXRlci5wdXNoKCcvc3lzdGVtL3N5c1JvbGUnKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAqBA;AACA;EACAA,gBADA;EAGAC,IAHA,kBAGA;IACA;MACAC,cADA;MACA;MACAC,eAFA;MAEA;MACAC;QACAC,oBADA;QAEAC;MAFA;IAHA;EAQA,CAZA;EAcAC,OAdA,qBAcA;IACA;EACA,CAhBA;EAkBAC;IACA;AACA;AACA;IACAC,SAJA,uBAIA;MAAA;;MACA;MACAC;QACA;QACA;;QACA;;QACAC;;QACA;MACA,CANA;IAOA,CAbA;;IAeA;AACA;AACA;IACAC,aAlBA,yBAkBAC,KAlBA,EAkBA;MAAA;;MAAA;MACA;QACA;UACAC;QACA,CAFA,MAEA;UACA;QACA;;QACA;MACA,CAPA,EAOAC,OAPA;IAQA,CA3BA;;IA6BA;AACA;AACA;IACAC,IAhCA,kBAgCA;MAAA;;MACA;MACA;MACA;MACA;MACA;QAAA;MAAA;MACAL;MACA;QACAM,4BADA;QAEAC;MAFA;MAIA;MACAR;QACA;;QACA;;QACA;MACA,CAJA;IAKA;EAjDA;AAlBA","names":["name","data","loading","sysMenuList","defaultProps","children","label","created","methods","fetchData","api","console","getCheckedIds","auths","pre","initArr","save","roleId","menuIdList"],"sourceRoot":"src/views/system/sysRole","sources":["assignAuth.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div style=\"padding: 20px 20px 0 20px;\">\n      授权角色：{{ $route.query.roleName }}\n    </div>\n    <el-tree\n      style=\"margin: 20px 0\"\n      ref=\"tree\"\n      :data=\"sysMenuList\"\n      node-key=\"id\"\n      show-checkbox\n      default-expand-all\n      :props=\"defaultProps\"\n    />\n    <div style=\"padding: 20px 20px;\">\n      <el-button :loading=\"loading\" type=\"primary\" icon=\"el-icon-check\" size=\"mini\" @click=\"save\">保存</el-button>\n      <el-button @click=\"$router.push('/sysRole')\" size=\"mini\" icon=\"el-icon-refresh-right\">返回</el-button>\n    </div>\n  </div>\n</template>\n<script>\n  import api from '@/api/system/sysMenu'\n  export default {\n    name: 'roleAuth',\n\n    data() {\n      return {\n        loading: false, // 用来标识是否正在保存请求中的标识, 防止重复提交\n        sysMenuList: [], // 所有\n        defaultProps: {\n          children: 'children',\n          label: 'name'\n        },\n      };\n    },\n\n    created() {\n      this.fetchData()\n    },\n\n    methods: {\n      /*\n      初始化\n      */\n      fetchData() {\n        const roleId = this.$route.query.id\n        api.toAssign(roleId).then(result => {\n          const sysMenuList = result.data\n          this.sysMenuList = sysMenuList\n          const checkedIds = this.getCheckedIds(sysMenuList)\n          console.log('getPermissions() checkedIds', checkedIds)\n          this.$refs.tree.setCheckedKeys(checkedIds)\n        })\n      },\n\n      /*\n      得到所有选中的id列表\n      */\n      getCheckedIds (auths, initArr = []) {\n        return auths.reduce((pre, item) => {\n          if (item.select && item.children.length === 0) {\n            pre.push(item.id)\n          } else if (item.children) {\n            this.getCheckedIds(item.children, initArr)\n          }\n          return pre\n        }, initArr)\n      },\n\n      /*\n      保存权限列表\n      */\n      save() {\n        //获取到当前子节点\n        //const checkedNodes = this.$refs.tree.getCheckedNodes()\n        //获取到当前子节点及父节点\n        const allCheckedNodes = this.$refs.tree.getCheckedNodes(false, true);\n        let idList = allCheckedNodes.map(node => node.id);\n        console.log(idList)\n        let assginMenuVo = {\n          roleId: this.$route.query.id,\n          menuIdList: idList\n        }\n        this.loading = true\n        api.doAssign(assginMenuVo).then(result => {\n          this.loading = false\n          this.$message.success(result.$message || '分配权限成功')\n          this.$router.push('/system/sysRole');\n        })\n      }\n    }\n  };\n</script>\n"]}]}
